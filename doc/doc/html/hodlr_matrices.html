<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BUTTERFLYPACK v@PROJECT_VERSION@: HODLR Approximation of Dense Matrices</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="../custom-style/my_customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname" style="font-family: silom;"><a href="#"><img src="logo.png" style="height:80px"></a>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('hodlr_matrices.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">HODLR Approximation of Dense Matrices </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >We recommend to use the strumpack::structured::StructuredMatrix interface instead of directly using the HODLR classes. See <a class="el" href="dense.html">Dense Solvers </a>.</p>
<p >HODLR, or Hierarchically Off-Diagonal Low Rank, is a rank-structured format that is similar to HSS, but simpler. It uses the same weak admissibility, i.e, all off-diagonal blocks are low rank, but it does not use nested bases. Compared to HSS, HODLR theoretically has worse asymptotic complexity, but the algorithms might be faster in practice for medium sized problems.</p>
<p >STRUMPACK's HODLR code uses an external library, which can be found here: <a class="el" href=""><a href="https://github.com/liuyangzhuan/ButterflyPACK">https://github.com/liuyangzhuan/ButterflyPACK</a> </a></p>
<p >See the <a class="el" href="installation.html">Installation and Requirements</a> instructions for how to configure and compile STRUMPACK with support for HODLR.</p>
<p >The HODLR include files are installed in the <b>include/HODLR/</b> subdirectory, or in <b>src/HODLR/</b>. All HODLR code is in the namespace strumpack::HODLR. The main class for sequential/multithreaded as well as distributed memory HODLR matrices is strumpack::HODLR::HODLRMatrix.</p>
<p >We use a simple wrapper class strumpack::DenseMatrix, as a wrapper around a column-major matrix. See the documentation for that class for more info.</p>
<h1><a class="anchor" id="autotoc_md31"></a>
HODLR Matrix Construction</h1>
<p >There are currently 3 ways to construct an HODLR matrix:</p>
<ul>
<li>By specifying a matrix time (multiple-)vector product routine.</li>
<li>By specifying a matrix element evaluation routine.</li>
<li>By specifying a strumpack::kernel::Kernel object, containing a set of (high-dimensional) points and a kernel function.</li>
</ul>
<h2><a class="anchor" id="autotoc_md32"></a>
HODLR Construction from Element Evaluation</h2>
<p >Use the constructor</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> strumpack::HODLR::HODLRMatrix</div>
<div class="line">      (<span class="keyword">const</span> strumpack::MPIComm&amp; c,                          <span class="comment">// MPI_Comm wrapper</span></div>
<div class="line">       <span class="keyword">const</span> strumpack::structured::ClusterTree&amp; tree,       <span class="comment">// partition/cluster tree</span></div>
<div class="line">       <span class="keyword">const</span> std::function&lt;scalar_t(                         <span class="comment">// return value = A(i,j)</span></div>
<div class="line">          <span class="keywordtype">int</span> i,                                             <span class="comment">// row coordinate</span></div>
<div class="line">          <span class="keywordtype">int</span> j,                                             <span class="comment">// column coordinate</span></div>
<div class="line">        )&gt;&amp; Aelem,                                           <span class="comment">// element extraction routine</span></div>
<div class="line">       <span class="keyword">const</span> strumpack::HODLR::HODLROptions&lt;scalar_t&gt;&amp; opts  <span class="comment">// options object</span></div>
<div class="line">    );</div>
</div><!-- fragment --><p >For example, to construct an HODLR approximation of a Toeplitz matrix:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;HODLR/HODLRMatrix.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">strumpack::MPIComm c;  <span class="comment">// defaults to MPI_COMM_WORLD</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> N = 1000;</div>
<div class="line">strumpack::structured::ClusterTree t(N);       <span class="comment">// construct a tree for an NxN matrix</span></div>
<div class="line">t.refine(32);                                  <span class="comment">// refine the tree</span></div>
<div class="line">strumpack::HODLR::HODLROptions&lt;double&gt; opts;</div>
<div class="line">opts.set_from_command_line(argc, argv);        <span class="comment">// optionally, parse command line options</span></div>
<div class="line">strumpack::HODLR::HODLRMatrix&lt;double&gt;</div>
<div class="line">     H(c, t, [](<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j) {</div>
<div class="line">        <span class="keywordflow">return</span> (i==j) ? 1. : 1./(1+abs(i-j)); },</div>
<div class="line">       opts);</div>
<div class="line">H.factor();</div>
<div class="line">...</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md33"></a>
HODLR Construction from Matrix-Vector Multiplication</h2>
<p >Use the constructor</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> strumpack::HODLR::HODLRMatrix</div>
<div class="line">      (<span class="keyword">const</span> strumpack::MPIComm&amp; c,                          <span class="comment">// MPI_Comm wrapper</span></div>
<div class="line">       <span class="keyword">const</span> strumpack::structured::ClusterTree&amp; tree,       <span class="comment">// partition/cluster tree</span></div>
<div class="line">       <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span>(                             <span class="comment">// matrix-vector multiplication routine</span></div>
<div class="line">          strumpack::Trans op,                               <span class="comment">// none, transpose, conjugate</span></div>
<div class="line">          <span class="keyword">const</span> strumpack::DenseMatrix&lt;scalar_t&gt;&amp; R,         <span class="comment">// input (random matrix)</span></div>
<div class="line">          strumpack::DenseMatrix&lt;scalar_t&gt;&amp; S                <span class="comment">// output, compute as S = op(A)*R (S already allocated) </span></div>
<div class="line">        )&gt;&amp; Amult,</div>
<div class="line">       <span class="keyword">const</span> strumpack::HODLR::HODLROptions&lt;scalar_t&gt;&amp; opts  <span class="comment">// options object</span></div>
<div class="line">    );</div>
</div><!-- fragment --><p >The strumpack::MPIComm object is a simple wrapper around an MPI communicator. The partition or cluster tree data structure is the same as for HSS matrices. See dense_matrices for how to construct this tree.</p>
<h1><a class="anchor" id="autotoc_md34"></a>
Kernel Matrix Approximation</h1>
<p >We have an optimized HODLR construction algorithm for the so called kernel matrices, which arise in several applications, such as kernel ridge regression in machine learning. One can use the strumpack::HODLR::HODLRMatrix constructor:</p>
<div class="fragment"><div class="line">strumpack::HODLR::HODLRMatrix(strumpack::kernel::Kernel&lt;scalar_t&gt;&amp; K,</div>
<div class="line">                              std::vector&lt;int&gt;&amp; perm,</div>
<div class="line">                              <span class="keyword">const</span> strumpack::HODLR::HODLROptions&lt;scalar_t&gt;&amp; opts);</div>
</div><!-- fragment --><p >However, for kernel ridge regression, the strumpack::kernel::Kernel class provides some easy to use driver routines, see</p>
<div class="fragment"><div class="line">strumpack::DenseMatrix&lt;scalar_t&gt;</div>
<div class="line">strumpack::kernel::Kernel::fit_HODLR(<span class="keyword">const</span> MPIComm&amp; c,</div>
<div class="line">                                     std::vector&lt;scalar_t&gt;&amp; labels,</div>
<div class="line">                                     <span class="keyword">const</span> strumpack::HODLR::HODLROptions&lt;scalar_t&gt;&amp; opts);</div>
<div class="line">std::vector&lt;scalar_t&gt;</div>
<div class="line">strumpack::kernel::Kernel::predict(<span class="keyword">const</span> strumpack::DenseMatrix&lt;scalar_t&gt;&amp; test,</div>
<div class="line">                                   <span class="keyword">const</span> strumpack::DenseMatrix&lt;scalar_t&gt;&amp; weights);</div>
</div><!-- fragment --><p >There is also a Python interface to these Kernel regression routines, compatibile with scikit-learn, see <b>install/python/STRUMPACKKernel.py</b> and <b>examples/dense/KernelRegressionMPI.py</b>.</p>
<h1><a class="anchor" id="autotoc_md35"></a>
HODLR Matrix Operations</h1>
<p ><b>TODO</b> discuss parallel storage, mult, factor, solve, inv_mult, etc.. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dense.html">Dense Solvers</a></li>
    <li><a href="https://github.com/pghysels/STRUMPACK">STRUMPACK on Github</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
